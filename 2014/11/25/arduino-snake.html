<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Arduino: Snake on 8x8 LED Matrix</title>
  <meta name="description" content="wait.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://ironhead.bitbucket.com/2014/11/25/arduino-snake.html">

  <script type="text/javascript"
           src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">iRonhead</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
            
              <a class="page-link" href="/about/">About</a>
            
          
        
          
            
              <a class="page-link" href="/cv/">CV</a>
            
          
        
          
            
          
        
          
            
          
        
          
            
          
        
          
            
              <a class="page-link" href="/projects/">Projects</a>
            
          
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Arduino: Snake on 8x8 LED Matrix</h1>
    <p class="post-meta">Nov 25, 2014</p>
  </header>

  <article class="post-content">
    <h2 id="source-code-on-githubhttpsgithubcomimironheadarduino-practice"><a href="https://github.com/imironhead/arduino-practice">Source Code on Github</a></h2>

<p><img src="/assets/images/arduino_snake_v1.jpg" alt="arduino_snake_v1" /></p>

<p><a href="https://youtu.be/VC2F66MZuh0">YouTube</a></p>

<h3 id="hardware-required">Hardware Required</h3>

<ul>
  <li>Arduino Board</li>
  <li>8x8 LED Matrix</li>
  <li>Infrared Sensor</li>
  <li>220 ohm resistor</li>
  <li>Hook-up wires</li>
  <li>breadboard</li>
  <li>remote control</li>
</ul>

<h3 id="library">Library</h3>

<ul>
  <li><a href="https://github.com/coopermaa/Arduino-IRremote">Arduino-IRremote</a></li>
</ul>

<h3 id="how-to-receive-ir">How to Receive IR</h3>

<p>Get <a href="https://github.com/coopermaa/Arduino-IRremote">Arduino-IRremote</a>, change forlder name to ‘IRremote’ and put it into Arduino IDE’s subdirectory. If you work on OS X, find Arduino.app in Applications folder, open its context menu and select ‘Show Package Contents’. Then put ‘IRremote’ under ‘Arduino.app/contents/java/libraries/’. Re-launch Arduino IDE and you’ll find ‘IRremote’ examples.</p>

<p>To make sure we can receive infrared singnals, prepare a circuit to test it. A infrared sensor has 3 pins, connect the middle pin to ground. Connect the other 2 pins to 3.3v and pin 11 on Arduino. Between the pin of sensor and 3.3v pin, connect a 220 ohm resistor. Then upload the IRrecvDemo code to Arduino. If everything is fine, you could read something on serial monitor.</p>

<p><img src="/assets/images/arduino-ir-sensor.jpg" alt="IR sensor" /></p>

<ul>
  <li>left pin -&gt; 11 pin of Arduino</li>
  <li>middle pin -&gt; GND of Arduino</li>
  <li>right pin -&gt; 220 ohm resistor -&gt; 3.3v pin of Arduino</li>
</ul>

<p>In the source code of snake, A0 pin is used instead 11 pin.</p>

<h3 id="x8-led-matrix">8x8 LED Matrix</h3>

<p>Play the <a href="http://arduino.cc/en/Tutorial/RowColumnScanning">Row Column Scanning example</a>, I have not run this example but connect the circuit as it.</p>

<p>To light up a LED, we have to connect it to a HIGH pin and a LOW pin. But there are only 16 pins on the 8x8 LED matrix which has only 2^16 combinations. To simulate 2^64 combinations, we have to do something like <a href="http://arduino.cc/en/Tutorial/PWM">PWM</a>. For example, if we want to light up LED in (1, 1), set pin of 1st row to HIGH and set pin of 1st column to LOW can tuen on the LED. In each loop, we turn on and off the LEDs.</p>

<p>The Refresh method is used to display the game on the LED matrix. In order to make the display stable, we need a stable refresh rate in this method. In other words, to display a pattern stablely, we must spend the same time period on each loop and LED. That’s why I turn off some LEDs twice (set a pin to HIGH twice).</p>

<pre><code class="language-cpp">void Refresh() {
  int row, col, msk;

  for (row = 0; row &lt; 8; ++row) {
    msk = this-&gt;masks[row];

    digitalWrite(SnakeBoard::ROW[row], HIGH);

    for (col = 0; col &lt; 8; ++col) {
      if (msk &amp; (1 &lt;&lt; col)) {
        digitalWrite(SnakeBoard::COL[col], LOW);
        digitalWrite(SnakeBoard::COL[col], HIGH);
      } else {
        digitalWrite(SnakeBoard::COL[col], HIGH);
        digitalWrite(SnakeBoard::COL[col], HIGH);
      }
    }

    digitalWrite(ROW[row], LOW);
  }
}
</code></pre>

<h3 id="the-final-result">The Final Result</h3>

<p>To run the source code, you have to define the singals from infrared sensor. You can find the correct value by running the ‘IRremote’ example.</p>

<p>Now we can combine a circuit from ‘IRremote’ and ‘Row Column Scanning’ example. Remember to change the data pin of infrared sensor from 11 to A0. Then upload the snake to Arduino and start to play!</p>

<pre><code class="language-cpp">#define REMOTE_UP               (0x85AEFD19)
#define REMOTE_DOWN             (0xB66D73CD)
#define REMOTE_RIGHT            (0x5C5C901D)
#define REMOTE_LEFT             (0x8F890759)
</code></pre>

<h3 id="update-20141127">Update 20141127</h3>

<p><img src="/assets/images/arduino_snake_v2.jpg" alt="arduino_snake_v2" /></p>

<ul>
  <li><a href="http://arduino.cc/en/tutorial/ShiftOut">ShiftOut Example</a>.</li>
  <li><a href="https://github.com/imironhead/arduino-practice/tree/master/arduino-snake-v2">Github</a></li>
</ul>

<p>Reconnect all column pins of the LED matrix to a 74HC595 chip (because I have only one in hand :)). Refresh method become:</p>

<pre><code class="language-cpp">void Refresh() {
  for (int row = 0; row &lt; 8; ++row) {
    digitalWrite(SnakeBoard::ROW[row], HIGH);

    digitalWrite(PIN_SIFTING_OUT_LATCH, LOW);
    shiftOut(
      PIN_SIFTING_DATA,
      PIN_SIFTING_CLOCK,
      LSBFIRST,
      ~(unsigned char)this-&gt;masks[row]);
    digitalWrite(PIN_SIFTING_OUT_LATCH, HIGH);

    digitalWrite(PIN_SIFTING_OUT_LATCH, LOW);
    shiftOut(PIN_SIFTING_DATA, PIN_SIFTING_CLOCK, MSBFIRST, 255);
    digitalWrite(PIN_SIFTING_OUT_LATCH, HIGH);

    digitalWrite(ROW[row], LOW);
  }
}
</code></pre>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">iRonhead</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>iRonhead</li>
          <li><a href="mailto:ironhead.chuang@gmail.com">ironhead.chuang@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">wait.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
