---
layout: post
title: "swift 筆記 - 基礎"
description: ""
category:
tags: ["programming", "swift"]
---

這是瀏覽 "The Swift Programming Language" 的筆記，我平常主要用 c/c++，python，ruby 寫程式，這份筆記記的是我眼中的 swift。


## 變數與常數

~~~ swift
let x = 10    // let => x 是常數
var y = 100   // var => y 是變數
~~~


## 變數型別

如果編譯器可以從變數的初始值判斷型別，可以不明確的寫出型別。
~~~ swift
let x: String           // x 的型別是 String
var y: Double           // y 的型別是 Double

var a, b, c : Double    // a, b, c 的型別都是 Double

var x = "ironhead"      // x 的型別是 String
~~~


## 變數名稱可以是 unicode

我覺得用處不大，除非鍵盤可以輕易打出這些字。

~~~ swift
let π = 3.14159
let 你好 = "你好世界"
~~~


## 印出字串

~~~ swift
print("hello")              // 印出 hello 不換行
println("hello")            // 印出 hello 並換行

var name = "ironhead"

println("hello \(name)")    // 印出 hello ironhead 並換行
~~~


## 註解

跟 c/c++ 一樣，但是可以這麼做  /\* hello /\* world \*/ !!! \*/

## 除非要在一行內寫出多個式子，否則可以不加分號

~~~ swift
let name = "cat"; print(name)
~~~


## 整數

* 在 32-bit 平台上，Int 跟 Int32 一樣，UInt 跟 UInt32 一樣
* 在 64-bit 平台上，Int 跟 Int64 一樣，UInt 跟 UInt64 一樣

~~~ swift
let minValue = UInt8.min  // minValue 的型別是 UInt8 而且值是 0
let maxValue = UInt8.max  // maxValue 的型別是 UInt8 而且值是 255

let a = 100000      // 10 進位整數
let b = 0b1001      //  2 進位整數
let c = 0o2121      //  8 進位整數
let d = 0xffee      // 16 進位整數
let e = 1_000_000   // 1000000 ，加底線增加可讀性
~~~


## 浮點數

未指定型別時，預設為 Double

~~~ swift
let aDouble = 12.1875
let bDouble = 1.21875e1
let cDouble = 0xC.3p0         // 16 進位, p快示以 2為底的指數
let dDouble = 000123.456
let eDouble = 1_000.000_001   // 用底線增加可讀性
~~~


## 型別轉換

~~~ swift
let a: UInt8 = -1             // 編譯錯誤
let b: Int8 = Int8.max + 1    // 編譯錯誤

let c = Int(1.23)             // 將 Double 轉換成 Int
~~~


## 型別別名

相當於 c++ 的 typedef
~~~ swift
typealias Length = UInt16

var length = Length.max
~~~


## 多元組（Tuples）

* 可用在當函式需要超過一個回傳值時
* 簡易的暫用結構（struct）

~~~ swift
let http404Error = (404, "Not Found")                         // 型別是 (Int, String)

let (statusCode, statusMessage) = http404Error

println("The status code is \(statusCode)")
println("The status message is \(statusMessage)")

let (justTheStatusCode, _) = http404Error                     // 不需要的值可以用 _ 代替
println("The status code is \(justTheStatusCode)")

println("The status code is \(http404Error.0)")               // 可以用 index，從 0開始
println("The status message is \(http404Error.1)")            // 可以用 index，從 0開始

let http200Status = (statusCode: 200, description: "OK")      // 可以替欄位取名字

println("The status code is \(http200Status.statusCode)")     // 然後用欄位取值
println("The status message is \(http200Status.description)")
~~~


## Optionals（中文是啥？）
這是新的概念，在c/c++或python裡沒有。
簡單地說就是一個變數有兩個狀態，其中一個狀態表示正常的值，另一個狀態表示不存在這個值。
比如在c/c++裡記錄字數時可能會用整數來儲存，而且 0行是合理的，
然後用小於 0行來表示這個變數還沒被初始化。「小於零」就是一個特別的狀態。

~~~ swift
var line: Int?    // 型別之後加上問號，就成為一個新的 optional型別

line = nil        // 所有的optional變數，都用 nil表示「不存在」
                  // 現在line變數不存在任何值

line = 1024
~~~

在這樣的情況下可讀性較高，字串轉換成整數時有可能因為不合格的格式轉換失敗，
有些語言的處理方式是傳回特別的值，但是這種情況下所有的整數都應該是合理的。
另一種方法是丟出異常（我特別不喜歡異常）。這時傳回的型別可以是 optional，
可能有值，如果失敗則是 nil（另一個原因是swift裡如果不是optional就不能是nil）。
~~~ swift
let possibleNumber = "123"
let convertedNumber = possibleNumber.toInt()  // convertedNumber 是 Int?
~~~

~~~ swift
var a: Int?   // optional 預設初始為 nil

if a == nil {
  // 如果 a是 nil的話就....
  // 如果替 nil的 optional 變數加上驚嘆號，產生執行時期錯誤
  println("\(a!)")
} else {
  // 不能直接使用 optional 變數
  // 加上驚嘆號告訴編譯器「我確定 a有值，不是 nil」
  println("\(a!)")
}
~~~

~~~ swift
var a: Int?

......

if let b = a {
  // 如果 a 不是 nil
  //  b是 Int，不是 Int? 了，不需要加 !
  println("\(b)")
} else {
  // 如果 a 是 nil
}

~~~

加 !的 optional變數跟加 ?的 optional變數一樣，但是可以當一般變數使用，取用時不需要再加上 !。
通常用在一開始是 nil（不是 optional就不能是 nil），但是一經付值後就不會再變回 nil的變數。
~~~ swift
let possibleString: String? = "An optional string."
let forcedString: String = possibleString!

let assumedString: String! = "An implicitly unwrapped optional string."
let implicitString: String = assumedString
~~~

**swift 的 nil 跟 Objective-C 的 nil 不一樣**

* swift：表示「不存在」，不限定物件
* obj-c：表示指到「一個不存在的物件」的指標


## 警告（assertions）

[在release版本上無作用](https://developer.apple.com/swift/blog/?id=4)
~~~ swift
let age = -3
assert(age >= 0, "A person's age cannot be less than zero")
~~~
